(window.webpackJsonp=window.webpackJsonp||[]).push([[207],{14943:function(s,n,a){"use strict";a.r(n);var t=a(2),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h3",{attrs:{id:"_1-面试题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-面试题"}},[s._v("#")]),s._v(" 1，面试题")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("Q54: 你了解过docker哪些跨主机通信网络解决方案?\n\n-----------------------------\n\nQ55:docker容器如何实现数据持久化?\n\n-----------------------------\n\nQ56:如何查找一个正在运行的容器正在用哪个存储卷?\n\n-----------------------------\n\nQ57:docker底层用到了哪些Linux技术?\n\n-----------------------------\n\nQ58:简单陈述下overlayFs的原理?\n\n-----------------------------\n\nQ59:你了解过哪些Dockerfile指令?\n\n-----------------------------\n\nQ60:简单陈述下RUN和CMD指令的区别?\n\n-----------------------------\n\nQ61:简单陈述下构建Dockerfile的流程?\n\n-----------------------------\n\nQ62:简单陈述下Dockerfile和镜像的区别?使用Dockerfile有哪些优势?最少说出3点。\n\n-----------------------------\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br")])]),n("h3",{attrs:{id:"_2-add指令之游戏镜像制作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-add指令之游戏镜像制作"}},[s._v("#")]),s._v(" 2，ADD指令之游戏镜像制作")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("jasonyin2020/oldboyedu-games 这个镜像是有很多小游戏\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image ls")]),s._v("\nREPOSITORY                     TAG       IMAGE ID       CREATED          SIZE\nmalu-linux                     v1.0      caf219759e53   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.3      7de35fbaece8   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("46")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.2      70031684dcfc   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.1      1e2b2b362aa6   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(".6MB\nalpine                         latest    91ef0af61f39   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" months ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8MB\njasonyin2020/oldboyedu-games   v0.6      b55cbfca1946   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago     376MB\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":37 ./\ndrwx------ "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":34 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":37 case01-nginx/  昨天的第1个Dockerfile案例\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll case01-nginx/")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":37 ./\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":37 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("573")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":06 Dockerfile\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("160")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":52 malu-nginx.conf\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir case02-nginx-games")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd case02-nginx-games/")]),s._v("\n\n-------------------------- \n\n找一个游戏镜像：\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --name games jasonyin2020/oldboyedu-games:v0.6 ")]),s._v("\ned872556cd1fab27b0ae635576d912880c6c12e72c1572707b1ba4683fb91b8e\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE                               COMMAND                  CREATED         STATUS         PORTS     NAMES\ned872556cd1f   jasonyin2020/oldboyedu-games:v0.6   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/docker-entrypoint.…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp    games\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it games sh")]),s._v("\n/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx -t")]),s._v("\nnginx: the configuration "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" /etc/nginx/nginx.conf syntax is ok\nnginx: configuration "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" /etc/nginx/nginx.conf "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" is successful\n/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/nginx/conf.d/games.conf ")]),s._v("\nserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    root          /usr/local/nginx/html/bird/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server_name   game01.oldboyedu.com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    root          /usr/local/nginx/html/pinshu/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server_name   game02.oldboyedu.com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    root          /usr/local/nginx/html/tanke/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server_name   game03.oldboyedu.com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /usr/local/nginx/html/")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -l")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("104")]),s._v("\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" bird\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Mar  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v(" buyu\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" chengbao\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" dayu\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" doudizhu\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" feijidazhan\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" huangjinkuanggong\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Mar  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v(" huimiejiangshi\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" killbird\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" liferestart\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v(" maliao\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" menghuanmonizhan\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" motuo\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" pingtai\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" pinshu\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" qieshuiguo\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Mar  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v(" renzhegame\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" tanke\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Mar  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v(" tankedazhan\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Mar  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v(" tiaoyitiao\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" wangzhezhicheng\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" xiaobawang\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Mar  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v(" yangyang\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" zhiwuVSjiangshi\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" zhiwudazhanjiangshi\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Mar  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v(" zombie-master\n\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar zcf killbird.tar.gz killbird")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar zcf huangjinkuanggong.tar.gz huangjinkuanggong")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -l")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" bird\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Mar  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v(" buyu\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" chengbao\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" dayu\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" doudizhu\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" feijidazhan\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" huangjinkuanggong\n-rw-r--r--    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4089105")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":45 huangjinkuanggong.tar.gz\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Mar  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v(" huimiejiangshi\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(" killbird\n-rw-r--r--    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("919045")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":44 killbird.tar.gz\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd case02-nginx-games/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir code")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd code/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pwd")]),s._v("\n/root/alpine/case02-nginx-games/code\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker cp games:/usr/local/nginx/html/huangjinkuanggong.tar.gz ./")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker cp games:/usr/local/nginx/html/killbird.tar.gz ./")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nhuangjinkuanggong.tar.gz  killbird.tar.gz\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir config")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":48 ./\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":38 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":47 code/\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":48 config/\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd config/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim games.conf")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat games.conf ")]),s._v("\nserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    root          /usr/local/nginx/html/killbird/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server_name   game01.oldboyedu.com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\nserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    root          /usr/local/nginx/html/huangjinkuanggong/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server_name   game02.oldboyedu.com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim Dockerfile")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM malu-linux:v1.0\n\nMAINTAINER malu\n\nCOPY config/games.conf /etc/nginx/http.d/games.conf\n\nCOPY code/huangjinkuanggong.tar.gz /\nCOPY code/killbird.tar.gz /\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf /huangjinkuanggong.tar.gz "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" /usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf /killbird.tar.gz "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" /usr/local/nginx/html\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ADD 指令可以自动解压tar包文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ADD code/huangjinkuanggong.tar.gz /usr/local/nginx/html")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ADD code/killbird.tar.gz /usr/local/nginx/html")]),s._v("\n\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /huangjinkuanggong.tar.gz /killbird.tar.gz\n\n------------------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image build -t malu-linux:v1.2 .")]),s._v("\nSending build context to Docker daemon  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".015MB\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/7 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" FROM malu-linux:v1.0\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" caf219759e53\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/7 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" MAINTAINER malu\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" e5caf612630e\nRemoving intermediate container e5caf612630e\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" a084f7b86ecf\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/7 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" COPY config/games.conf /etc/nginx/http.d/games.conf\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" d2637b6621d7\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("/7 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" COPY code/huangjinkuanggong.tar.gz /\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 1b366ede46fe\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/7 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" COPY code/killbird.tar.gz /\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" e99469e8edee\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("/7 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf /huangjinkuanggong.tar.gz "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" /usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf /killbird.tar.gz "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" /usr/local/nginx/html\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 8c08f25b5338\nRemoving intermediate container 8c08f25b5338\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" c0be84056313\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("/7 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /huangjinkuanggong.tar.gz /killbird.tar.gz\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 524b813fbd7f\nRemoving intermediate container 524b813fbd7f\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ebee4d6caca8\nSuccessfully built ebee4d6caca8\nSuccessfully tagged malu-linux:v1.2\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image ls")]),s._v("\nREPOSITORY                     TAG       IMAGE ID       CREATED             SIZE\nmalu-linux                     v1.2      ebee4d6caca8   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" seconds ago       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(".7MB\nmalu-linux                     v1.0      caf219759e53   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v(" minutes ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.3      7de35fbaece8   About an hour ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.2      70031684dcfc   About an hour ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.1      1e2b2b362aa6   About an hour ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(".6MB\nalpine                         latest    91ef0af61f39   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" months ago        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8MB\njasonyin2020/oldboyedu-games   v0.6      b55cbfca1946   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago        376MB\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --name mygame01 -p 82:80 malu-linux:v1.2 ")]),s._v("\n5e30588ae8e49422bdfd89b799324281fcd407f9c6dc18053526aa7b23fe48e6\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps ")]),s._v("\nCONTAINER ID   IMAGE                               COMMAND                  CREATED             STATUS             PORTS                               NAMES\n5e30588ae8e4   malu-linux:v1.2                     "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds ago       Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" seconds       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:82-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::82-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   mygame01\ned872556cd1f   jasonyin2020/oldboyedu-games:v0.6   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/docker-entrypoint.…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" minutes ago      Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" minutes      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp                              games\nb99af534e6dc   malu-linux:v1.0                     "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v(" minutes ago      Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("42")]),s._v(" minutes      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::80-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   web\n91b027dae662   malu-linux:v0.3                     "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail -f /etc/hosts"')]),s._v("     About an hour ago   Up About an hour                                       hehe\nccbdaa0cb2ed   malu-linux:v0.3                     "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   About an hour ago   Up About an hour                                       haha\nb446ee8bef72   malu-linux:v0.2                     "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   About an hour ago   Up About an hour                                       xixi\n05265a26c461   malu-linux:v0.1                     "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   About an hour ago   Up About an hour                                       myweb\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br"),n("span",{staticClass:"line-number"},[s._v("153")]),n("br"),n("span",{staticClass:"line-number"},[s._v("154")]),n("br"),n("span",{staticClass:"line-number"},[s._v("155")]),n("br"),n("span",{staticClass:"line-number"},[s._v("156")]),n("br"),n("span",{staticClass:"line-number"},[s._v("157")]),n("br"),n("span",{staticClass:"line-number"},[s._v("158")]),n("br"),n("span",{staticClass:"line-number"},[s._v("159")]),n("br"),n("span",{staticClass:"line-number"},[s._v("160")]),n("br"),n("span",{staticClass:"line-number"},[s._v("161")]),n("br"),n("span",{staticClass:"line-number"},[s._v("162")]),n("br"),n("span",{staticClass:"line-number"},[s._v("163")]),n("br"),n("span",{staticClass:"line-number"},[s._v("164")]),n("br"),n("span",{staticClass:"line-number"},[s._v("165")]),n("br"),n("span",{staticClass:"line-number"},[s._v("166")]),n("br"),n("span",{staticClass:"line-number"},[s._v("167")]),n("br"),n("span",{staticClass:"line-number"},[s._v("168")]),n("br"),n("span",{staticClass:"line-number"},[s._v("169")]),n("br"),n("span",{staticClass:"line-number"},[s._v("170")]),n("br"),n("span",{staticClass:"line-number"},[s._v("171")]),n("br"),n("span",{staticClass:"line-number"},[s._v("172")]),n("br"),n("span",{staticClass:"line-number"},[s._v("173")]),n("br"),n("span",{staticClass:"line-number"},[s._v("174")]),n("br"),n("span",{staticClass:"line-number"},[s._v("175")]),n("br"),n("span",{staticClass:"line-number"},[s._v("176")]),n("br"),n("span",{staticClass:"line-number"},[s._v("177")]),n("br"),n("span",{staticClass:"line-number"},[s._v("178")]),n("br"),n("span",{staticClass:"line-number"},[s._v("179")]),n("br"),n("span",{staticClass:"line-number"},[s._v("180")]),n("br"),n("span",{staticClass:"line-number"},[s._v("181")]),n("br"),n("span",{staticClass:"line-number"},[s._v("182")]),n("br"),n("span",{staticClass:"line-number"},[s._v("183")]),n("br"),n("span",{staticClass:"line-number"},[s._v("184")]),n("br"),n("span",{staticClass:"line-number"},[s._v("185")]),n("br"),n("span",{staticClass:"line-number"},[s._v("186")]),n("br"),n("span",{staticClass:"line-number"},[s._v("187")]),n("br"),n("span",{staticClass:"line-number"},[s._v("188")]),n("br"),n("span",{staticClass:"line-number"},[s._v("189")]),n("br"),n("span",{staticClass:"line-number"},[s._v("190")]),n("br"),n("span",{staticClass:"line-number"},[s._v("191")]),n("br"),n("span",{staticClass:"line-number"},[s._v("192")]),n("br"),n("span",{staticClass:"line-number"},[s._v("193")]),n("br"),n("span",{staticClass:"line-number"},[s._v("194")]),n("br"),n("span",{staticClass:"line-number"},[s._v("195")]),n("br"),n("span",{staticClass:"line-number"},[s._v("196")]),n("br"),n("span",{staticClass:"line-number"},[s._v("197")]),n("br"),n("span",{staticClass:"line-number"},[s._v("198")]),n("br"),n("span",{staticClass:"line-number"},[s._v("199")]),n("br"),n("span",{staticClass:"line-number"},[s._v("200")]),n("br"),n("span",{staticClass:"line-number"},[s._v("201")]),n("br"),n("span",{staticClass:"line-number"},[s._v("202")]),n("br"),n("span",{staticClass:"line-number"},[s._v("203")]),n("br"),n("span",{staticClass:"line-number"},[s._v("204")]),n("br"),n("span",{staticClass:"line-number"},[s._v("205")]),n("br"),n("span",{staticClass:"line-number"},[s._v("206")]),n("br"),n("span",{staticClass:"line-number"},[s._v("207")]),n("br"),n("span",{staticClass:"line-number"},[s._v("208")]),n("br"),n("span",{staticClass:"line-number"},[s._v("209")]),n("br")])]),n("p",[s._v("测试：")]),s._v(" "),n("p",[n("img",{attrs:{src:a(7095),alt:"1730991944504"}})]),s._v(" "),n("p",[s._v("配置hosts：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.102 game01.oldboyedu.com\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.102 game02.oldboyedu.com\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:a(7096),alt:"1730992098410"}})]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("如果容器没有启动起来，排错思路：\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("82")]),s._v(":80 malu-linux:v1.2 "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /etc/hosts\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" vibrant_rubin "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n进入容器中，找错误\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("编写一个编译的脚本：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim build.sh")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TAG")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${1"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":-")]),s._v("3}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image build "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" malu-linux:v1."),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$TAG")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod +x build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh ")]),s._v("\nSending build context to Docker daemon  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".016MB\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nSuccessfully built ebee4d6caca8\nSuccessfully tagged malu-linux:v1.3\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("p",[s._v("优化：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM oldboyedu-linux:v1.0\n\nMAINTAINER Jason Yin\n\nCOPY config/games.conf /etc/nginx/http.d/games.conf\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#COPY code/huangjinkuanggong.tar.gz /")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#COPY code/killbird.tar.gz /")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#RUN mkdir -p /usr/local/nginx/html && \\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    tar xf /huangjinkuanggong.tar.gz -C /usr/local/nginx/html && \\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    tar xf /killbird.tar.gz -C /usr/local/nginx/html")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ADD 指令可以自动解压tar包文件")]),s._v("\nADD code/huangjinkuanggong.tar.gz /usr/local/nginx/html\nADD code/killbird.tar.gz /usr/local/nginx/html\n\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /oldboyedu-huangjinkuanggong.tar.gz /oldboyedu-killbird.tar.gz\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("h3",{attrs:{id:"_3-workdir指定工作目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-workdir指定工作目录"}},[s._v("#")]),s._v(" 3，WORKDIR指定工作目录")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".WORKDIR指定工作目录\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM malu-linux:v1.0\n\nMAINTAINER malu\n\nCOPY config/games.conf /etc/nginx/http.d/games.conf\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#COPY code/huangjinkuanggong.tar.gz /")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#COPY code/killbird.tar.gz /")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#RUN mkdir -p /usr/local/nginx/html && \\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    tar xf /huangjinkuanggong.tar.gz -C /usr/local/nginx/html && \\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    tar xf /killbird.tar.gz -C /usr/local/nginx/html")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ADD 指令可以自动解压tar包文件")]),s._v("\nADD code/huangjinkuanggong.tar.gz /usr/local/nginx/html\nADD code/killbird.tar.gz /usr/local/nginx/html\n\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /huangjinkuanggong.tar.gz /killbird.tar.gz\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# WORKDIR指定工作目录")]),s._v("\nWORKDIR  /usr/local/nginx/html\n\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".测试验证\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh 6")]),s._v("\nSuccessfully built f8726e53cf38\nSuccessfully tagged malu-linux:v1.6\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d malu-linux:v1.6")]),s._v("\nc5b2f05cd09c7f8c450b16490cbec301f9824cae76d48cfbbc2b74c7fb437351\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE             COMMAND                  CREATED          STATUS          PORTS                               NAMES\nc5b2f05cd09c   malu-linux:v1.6   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" seconds                                       strange_hamilton\n7f4ad627b790   malu-linux:v1.3   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" hours ago      Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" hours      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:82-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::82-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   mygame\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it strange_hamilton sh")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br")])]),n("h3",{attrs:{id:"_4-存储卷指令volume"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-存储卷指令volume"}},[s._v("#")]),s._v(" 4，存储卷指令VOLUME")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".编写Dockerfile\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume ls")]),s._v("\nDRIVER    VOLUME NAME\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim Dockerfile ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM malu-linux:v1.0\n\nMAINTAINER malu\n\nCOPY config/games.conf /etc/nginx/http.d/games.conf\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#COPY code/huangjinkuanggong.tar.gz /")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#COPY code/killbird.tar.gz /")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#RUN mkdir -p /usr/local/nginx/html && \\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    tar xf /huangjinkuanggong.tar.gz -C /usr/local/nginx/html && \\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    tar xf /killbird.tar.gz -C /usr/local/nginx/html")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ADD 指令可以自动解压tar包文件")]),s._v("\nADD code/huangjinkuanggong.tar.gz /usr/local/nginx/html\nADD code/killbird.tar.gz /usr/local/nginx/html\n\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /huangjinkuanggong.tar.gz /killbird.tar.gz\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# WORKDIR指定工作目录")]),s._v("\nWORKDIR  /usr/local/nginx/html\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# VOLUME指定存储卷目录，当启动容器时，会自动创建匿名(随机)存储卷,相当于启动时执行了"-v /usr/local/nginx/html"')]),s._v("\nVOLUME /usr/local/nginx/html\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".测试验证\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh 7")]),s._v("\nSuccessfully built ead88f7e5d5d\nSuccessfully tagged malu-linux:v1.7\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --name c1 malu-linux:v1.7")]),s._v("\n04aa8c2a40b30bb2b6b8d2dc8d2715d907e766bf93902a3f4cf266297a86b204\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE             COMMAND                  CREATED         STATUS         PORTS     NAMES\n04aa8c2a40b3   malu-linux:v1.7   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds             c1\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume ls")]),s._v("\nDRIVER    VOLUME NAME\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("     4965d80545cc11d5f647f8c782855e7be461cf193884d0763191acd9679c82a3\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker inspect -f "{{range .Mounts}}{{.Source}}{{end}}" c1')]),s._v("\n/var/lib/docker/volumes/4965d80545cc11d5f647f8c782855e7be461cf193884d0763191acd9679c82a3/_data\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /var/lib/docker/volumes/4965d80545cc11d5f647f8c782855e7be461cf193884d0763191acd9679c82a3/_data")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 08:11 ./\ndrwx-----x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 08:11 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 08:11 huangjinkuanggong/\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 08:11 killbird/\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br")])]),n("h3",{attrs:{id:"_5-expose暴露指定端口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-expose暴露指定端口"}},[s._v("#")]),s._v(" 5，EXPOSE暴露指定端口")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".编写Dockefile\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM malu-linux:v1.0\n\nMAINTAINER malu\n\nCOPY config/games.conf /etc/nginx/http.d/games.conf\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#COPY code/huangjinkuanggong.tar.gz /")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#COPY code/killbird.tar.gz /")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#RUN mkdir -p /usr/local/nginx/html && \\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    tar xf /huangjinkuanggong.tar.gz -C /usr/local/nginx/html && \\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    tar xf /killbird.tar.gz -C /usr/local/nginx/html")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ADD 指令可以自动解压tar包文件")]),s._v("\nADD code/huangjinkuanggong.tar.gz /usr/local/nginx/html\nADD code/killbird.tar.gz /usr/local/nginx/html\n\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /huangjinkuanggong.tar.gz /killbird.tar.gz\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# WORKDIR指定工作目录")]),s._v("\nWORKDIR  /usr/local/nginx/html\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# VOLUME指定存储卷目录，当启动容器时，会自动创建匿名(随机)存储卷,相当于启动时执行了"-v /usr/local/nginx/html"')]),s._v("\nVOLUME /usr/local/nginx/html\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露特定的服务端口，可以指定多个(使用空格分隔即可)，便于用户知晓哪些服务可以访问")]),s._v("\nEXPOSE "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".测试验证\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh 8")]),s._v("\nSuccessfully built eae43030d626\nSuccessfully tagged malu-linux:v1.8\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d malu-linux:v1.8")]),s._v("\nd76e1479bf222660cd2a887785cb8b6bde6383be8f491d486c4d052c5525979e\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE             COMMAND                  CREATED         STATUS         PORTS            NAMES\nd76e1479bf22   malu-linux:v1.8   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   focused_bartik\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP malu-linux:v1.8")]),s._v("\ncf7b1fa9ad2db42823fc041dfcbff8b5111e5d2c39b1413d176ad03f7bb3284c\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE             COMMAND                  CREATED         STATUS         PORTS                                                                              NAMES\ncf7b1fa9ad2d   malu-linux:v1.8   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32769-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32769-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32768-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32768-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   elegant_sammet\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br")])]),n("h3",{attrs:{id:"_6-env和arg指令实现环境变量传递"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-env和arg指令实现环境变量传递"}},[s._v("#")]),s._v(" 6，ENV和ARG指令实现环境变量传递")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".编写Dockefile \n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM malu-linux:v1.0\n\nMAINTAINER malu\n\nCOPY config/games.conf /etc/nginx/http.d/games.conf\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#COPY code/huangjinkuanggong.tar.gz /")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#COPY code/killbird.tar.gz /")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#RUN mkdir -p /usr/local/nginx/html && \\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    tar xf /huangjinkuanggong.tar.gz -C /usr/local/nginx/html && \\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    tar xf /killbird.tar.gz -C /usr/local/nginx/html")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ADD 指令可以自动解压tar包文件")]),s._v("\nADD code/huangjinkuanggong.tar.gz /usr/local/nginx/html\nADD code/killbird.tar.gz /usr/local/nginx/html\n\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /huangjinkuanggong.tar.gz /killbird.tar.gz\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# WORKDIR指定工作目录")]),s._v("\nWORKDIR  /usr/local/nginx/html\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# VOLUME指定存储卷目录，当启动容器时，会自动创建匿名(随机)存储卷,相当于启动时执行了"-v /usr/local/nginx/html"')]),s._v("\nVOLUME /usr/local/nginx/html\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露特定的服务端口，可以指定多个(使用空格分隔即可)，便于用户知晓哪些服务可以访问")]),s._v("\nEXPOSE "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ARG仅在构建阶段生效的环境变量")]),s._v("\nARG "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SCHOOL")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("malu "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLASS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ENV在构建阶段和容器运行阶段均能生效的环境变量")]),s._v("\nENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ADDRESS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zz "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ClassRoom")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1520")]),s._v("\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /ok/"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SCHOOL}")]),s._v(" /ok/"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CLASS}")]),s._v(" /ok/"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ADDRESS}")]),s._v(" /ok/"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ClassRoom}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".测试验证 \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh 9")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --name c2 malu-linux:v1.9")]),s._v("\n6bc255053cf5a14805e6dfc6e4e041b75ae46c640110483f379b09696e07d89c\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE             COMMAND                  CREATED         STATUS         PORTS            NAMES\n6bc255053cf5   malu-linux:v1.9   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   c2\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it c2 sh")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls /ok/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1520")]),s._v("   linux  malu   zz\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# env")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOSTNAME")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("6bc255053cf5\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SHLVL")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOME")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("TERM")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xterm\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PWD")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx/html\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ADDRESS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zz\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ClassRoom")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1520")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".构建阶段ARG的变量可以被覆盖，启动阶段ENV的指令也可以被覆盖\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image build -t malu-linux:v1.10 --build-arg SCHOOL=bd --build-arg CLASS=bd1 .")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -e ADDRESS=qh -e ClassRoom=qh2 -d --name c4 malu-linux:v1.10 ")]),s._v("\nbcec6fe345f95305b9a28f43c77a2ad471ccf6893ed21db4abae14f33b2f278e\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it c4 sh")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /ok/")]),s._v("\nsh: ll: not found\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -l /ok/")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 00:22 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1520")]),s._v("\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 00:22 bd\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 00:22 bd1\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 00:22 zz\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# env")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOSTNAME")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bcec6fe345f9\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SHLVL")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOME")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("TERM")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xterm\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PWD")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx/html\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ADDRESS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("qh\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ClassRoom")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("qh2\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br")])]),n("h3",{attrs:{id:"_7-手动制作镜像启用sshd服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-手动制作镜像启用sshd服务"}},[s._v("#")]),s._v(" 7，手动制作镜像启用sshd服务")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image ls")]),s._v("\nREPOSITORY                     TAG       IMAGE ID       CREATED          SIZE\nmalu-linux                     v1.10     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("630373682264")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.9      2eb3b308bbf2   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.8      eae43030d626   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("36")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.7      ead88f7e5d5d   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.6      f8726e53cf38   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.3      34b0ba85cc5a   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.2      ebee4d6caca8   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(".7MB\nmalu-linux                     v1.0      caf219759e53   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.3      7de35fbaece8   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.2      70031684dcfc   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.1      1e2b2b362aa6   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(".6MB\nalpine                         latest    91ef0af61f39   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" months ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8MB\njasonyin2020/oldboyedu-games   v0.6      b55cbfca1946   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago     376MB\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP malu-linux:v1.10")]),s._v("\n9aaf330b2b10308d2d22fc871907494ee35e95bca68708d69ca2b7781ca21e2c\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE              COMMAND                  CREATED         STATUS         PORTS                                                                              NAMES\n9aaf330b2b10   malu-linux:v1.10   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32771-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32771-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32770-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32770-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   relaxed_northcutt\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP malu-linux:v1.10")]),s._v("\n9aaf330b2b10308d2d22fc871907494ee35e95bca68708d69ca2b7781ca21e2c\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE              COMMAND                  CREATED         STATUS         PORTS                                                                              NAMES\n9aaf330b2b10   malu-linux:v1.10   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32771-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32771-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32770-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32770-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   relaxed_northcutt\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it relaxed_northcutt sh")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# apk add openssh-server")]),s._v("\nfetch https://mirrors.tuna.tsinghua.edu.cn/alpine/v3.20/main/x86_64/APKINDEX.tar.gz\nfetch https://mirrors.tuna.tsinghua.edu.cn/alpine/v3.20/community/x86_64/APKINDEX.tar.gz\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing openssh-keygen "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".7_p1-r4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing openssh-server-common "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".7_p1-r4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing openssh-server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".7_p1-r4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nExecuting busybox-1.36.1-r29.trigger\nOK: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" MiB "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" packages\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# which sshd")]),s._v("\n/usr/sbin/sshd\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /usr/sbin/sshd ")]),s._v("\nsshd: no hostkeys available -- exiting.\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-keygen -A")]),s._v("\nssh-keygen: generating new "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" keys: RSA ECDSA ED25519 \n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /usr/sbin/sshd ")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -ef")]),s._v("\nPID   "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("     TIME  COMMAND\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00 nginx: master process nginx "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" daemon off"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" nginx     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00 nginx: worker process\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" nginx     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00 nginx: worker process\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" root      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00 "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" root      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00 sshd: /usr/sbin/sshd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("listener"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" of "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("-100 startups\n   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" root      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00 "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ef")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n----------------------\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE              COMMAND                  CREATED         STATUS         PORTS                                                                              NAMES\n9aaf330b2b10   malu-linux:v1.10   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" minutes ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" minutes   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32771-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32771-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32770-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32770-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   relaxed_northcutt\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh 10.0.0.102 -p 32771")]),s._v("\nThe authenticity of "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[10.0.0.102]:32771 ([10.0.0.102]:32771)'")]),s._v(" can"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t be established.\nED25519 key fingerprint is SHA256:t1qc+DgGQc02jDZm+9nhH6Yf1sU3+nCghChALjR1HBo.\nThis key is not known by any other names\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.102"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":32771"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("' (ED25519) to the list of known hosts.\nroot@10.0.0.102'")]),s._v("s password: \n\n----------------------\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# grep PermitRootLogin /etc/ssh/sshd_config")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#PermitRootLogin prohibit-password")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# the setting of "PermitRootLogin prohibit-password".')]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed -i 's@#PermitRootLogin prohibit-password@PermitRootLogin yes@' /etc/ssh/sshd_config")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# grep PermitRootLogin /etc/ssh/sshd_config")]),s._v("\nPermitRootLogin "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# the setting of "PermitRootLogin prohibit-password".')]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n/usr/local/nginx/html "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo root:123456 | chpasswd")]),s._v("\nchpasswd: password "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v(" changed\n\n----------------------\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE              COMMAND                  CREATED          STATUS          PORTS                                                                              NAMES\n9aaf330b2b10   malu-linux:v1.10   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx -g \'daemon of…"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" minutes ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" minutes   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32771-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32771-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32770-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32770-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   relaxed_northcutt\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh 10.0.0.102 -p 32771")]),s._v("\nroot@10.0.0.102's password: \nWelcome to Alpine"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("https://wiki.alpinelinux.org/"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\n9aaf330b2b10:~"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br")])]),n("h3",{attrs:{id:"_7-docker构建多服务镜像实战案例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-docker构建多服务镜像实战案例"}},[s._v("#")]),s._v(" 7，Docker构建多服务镜像实战案例")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd ..")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir case03-nginx-games-sshd")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd case03-nginx-games-sshd/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pwd")]),s._v("\n/root/alpine/case03-nginx-games-sshd\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim Dockerfile")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM malu-linux:v1.10\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给镜像打标签，用于替代MAINTAINER")]),s._v("\nLABEL "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("school")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mlau "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("class")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux94 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("hobby")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("k8s "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("email")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("111111")]),s._v("@qq.com\n\nRUN apk "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" openssh-server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    ssh-keygen "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s@#PermitRootLogin prohibit-password@PermitRootLogin yes@'")]),s._v(" /etc/ssh/sshd_config "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" root:123456 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" chpasswd\n\n\nCOPY script/start.sh /\n\nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-x"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/start.sh"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat script/start.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/sh")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MALU_PWD"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" \n  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" root:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${MALU_PWD}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" chpasswd \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# start sshd service")]),s._v("\n/usr/sbin/sshd\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# start nginx service")]),s._v("\nnginx "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'daemon off;'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TAG")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${1"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":-")]),s._v("11}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image build "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" malu-linux:v1."),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$TAG")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh 11")]),s._v("\nSending build context to Docker daemon  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".608kB\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY                     TAG       IMAGE ID       CREATED             SIZE\nmalu-linux                     v1.11     1d86598d06ec   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds ago       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(".3MB\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP -e MALU_PWD=321 malu-linux:v1.11")]),s._v("\n5763d0d2c2c941041486e14145efaa4b62f6c5928a16978dc494b53223e67f8e\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE              COMMAND                  CREATED         STATUS         PORTS                                                                              NAMES\n5763d0d2c2c9   malu-linux:v1.11   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh -x /start.sh"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32775-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32775-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32774-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32774-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   practical_wilbur\n\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-nginx-games"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh 10.0.0.102 -p 32775")]),s._v("\nThe authenticity of "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[10.0.0.102]:32775 ([10.0.0.102]:32775)'")]),s._v(" can"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t be established.\nED25519 key fingerprint is SHA256:+zfvA/7f9VjQJYSei56Zc481j58V65ftMAbRZiQk92Y.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:7: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.102"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":32775"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("' (ED25519) to the list of known hosts.\nroot@10.0.0.102'")]),s._v("s password: \nWelcome to Alpine"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("https://wiki.alpinelinux.org/"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\n5763d0d2c2c9:~"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br")])]),n("h3",{attrs:{id:"_8-entrypoint和cmd指令的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-entrypoint和cmd指令的区别"}},[s._v("#")]),s._v(" 8，ENTRYPOINT和CMD指令的区别")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".编写Dockefile\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM malu-linux:v1.10\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给镜像打标签，用于替代MAINTAINER")]),s._v("\nLABEL "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("school")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mlau "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("class")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux94 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("hobby")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("k8s "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("email")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("111111")]),s._v("@qq.com\n\nRUN apk "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" openssh-server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    ssh-keygen "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s@#PermitRootLogin prohibit-password@PermitRootLogin yes@'")]),s._v(" /etc/ssh/sshd_config "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" root:123456 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" chpasswd\n\n\nCOPY script/start.sh /\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#CMD ["/bin/sh","-x","/start.sh"]')]),s._v("\nENTRYPOINT "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-x"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/start.sh"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh 12")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image ls")]),s._v("\nREPOSITORY                     TAG       IMAGE ID       CREATED          SIZE\nmalu-linux                     v1.12     35da5e9f0286   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" seconds ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(".3MB\nmalu-linux                     v1.11     1d86598d06ec   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" hours ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(".3MB\nmalu-linux                     v1.10     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("630373682264")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" hours ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.9      2eb3b308bbf2   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" hours ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.8      eae43030d626   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" hours ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.7      ead88f7e5d5d   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" hours ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.6      f8726e53cf38   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" hours ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.3      34b0ba85cc5a   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\nmalu-linux                     v1.2      ebee4d6caca8   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(".7MB\nmalu-linux                     v1.0      caf219759e53   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.3      7de35fbaece8   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.2      70031684dcfc   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".25MB\nmalu-linux                     v0.1      1e2b2b362aa6   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" hours ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(".6MB\nalpine                         latest    91ef0af61f39   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" months ago     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8MB\njasonyin2020/oldboyedu-games   v0.6      b55cbfca1946   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" months ago     376MB\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -e MALU_PWD=321 -dP malu-linux:v1.12 ")]),s._v("\n6599533f1c092243663897361de9379ac0329fc45ebc72c07eed17b966cdb6ef\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l --no-trunc")]),s._v("\nCONTAINER ID                                                       IMAGE              COMMAND                  CREATED          STATUS          PORTS                                                                              NAMES\n6599533f1c092243663897361de9379ac0329fc45ebc72c07eed17b966cdb6ef   malu-linux:v1.12   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh -x /start.sh"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32781-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32781-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32780-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32780-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   flamboyant_keldysh\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh 10.0.0.102 -p 32781")]),s._v("\nThe authenticity of "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[10.0.0.102]:32781 ([10.0.0.102]:32781)'")]),s._v(" can"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t be established.\nED25519 key fingerprint is SHA256:+zfvA/7f9VjQJYSei56Zc481j58V65ftMAbRZiQk92Y.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:7: [hashed name]\n    ~/.ssh/known_hosts:8: [hashed name]\n    ~/.ssh/known_hosts:9: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.102"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":32781"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("' (ED25519) to the list of known hosts.\nroot@10.0.0.102'")]),s._v("s password: \nWelcome to Alpine"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("https://wiki.alpinelinux.org/"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\n6599533f1c09:~"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n\n结论：ENTRYPOINT和CMD指令均可以独自使用，作为容器的启动命令"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("面试题: ENTRYPOINT和CMD的区别？\n\t相同点:\n\t\tENTRYPOINT和CMD指令均可以独自使用，作为容器的启动命令"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t不同点:\n\t\t- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".CMD指令在容器运行时可以被覆盖"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".ENTRYPOINT指令在容器运行时不可以被覆盖"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".当CMD和ENTRYPOINT同时使用，则CMD将作为参数传递给ENTRYPOINT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t\n\t\t\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM malu-linux:v1.10\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给镜像打标签，用于替代MAINTAINER")]),s._v("\nLABEL "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("school")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mlau "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("class")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux94 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("hobby")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("k8s "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("email")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("111111")]),s._v("@qq.com\n\nRUN apk "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" openssh-server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    ssh-keygen "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s@#PermitRootLogin prohibit-password@PermitRootLogin yes@'")]),s._v(" /etc/ssh/sshd_config "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" root:123456 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" chpasswd\n\n\nCOPY script/start.sh /\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#CMD ["/bin/sh","-x","/start.sh"]')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#ENTRYPOINT ["/bin/sh","-x","/start.sh"]')]),s._v("\n\nENTRYPOINT "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-f"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/hosts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh 13")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image ls")]),s._v("\nREPOSITORY                     TAG       IMAGE ID       CREATED          SIZE\nmalu-linux                     v1.13     6399e049e92f   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" seconds ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(".3MB\nmalu-linux                     v1.12     35da5e9f0286   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(".3MB\nmalu-linux                     v1.11     1d86598d06ec   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" hours ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(".3MB\nmalu-linux                     v1.10     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("630373682264")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" hours ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".6MB\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP malu-linux:v1.13 ")]),s._v("\n37d78cc176d9deba8584dafc62c86a73eb1c043eeae71f6efe0e8172cc69d024\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l --no-trunc")]),s._v("\nCONTAINER ID                                                       IMAGE              COMMAND                CREATED         STATUS         PORTS                                                                              NAMES\n37d78cc176d9deba8584dafc62c86a73eb1c043eeae71f6efe0e8172cc69d024   malu-linux:v1.13   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail -f /etc/hosts"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32783-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32783-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32782-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32782-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   frosty_noyce\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP malu-linux:v1.13 /etc/hostname")]),s._v("\n132cea390a7b00644425213b9f73ee7e2b9112f73288cd53b6d081a528e41352\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l --no-trunc")]),s._v("\nCONTAINER ID                                                       IMAGE              COMMAND                   CREATED          STATUS         PORTS                                                                              NAMES\n132cea390a7b00644425213b9f73ee7e2b9112f73288cd53b6d081a528e41352   malu-linux:v1.13   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail -f /etc/hostname"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32785-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32785-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32784-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP malu-linux:v1.13 /ok")]),s._v("\n9c0eaf7ad845f8ec390f6a4dbe64d200cf443579ba5dfff39312556d96511691\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l --no-trunc")]),s._v("\nCONTAINER ID                                                       IMAGE              COMMAND         CREATED         STATUS         PORTS                                                                              NAMES\n9c0eaf7ad845f8ec390f6a4dbe64d200cf443579ba5dfff39312556d96511691   malu-linux:v1.13   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail -f /ok"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32787-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32787-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32786-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32786-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   thirsty_mcclintock\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br")])]),n("h3",{attrs:{id:"_9-使用entrypoint实现密码的修改"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-使用entrypoint实现密码的修改"}},[s._v("#")]),s._v(" 9，使用ENTRYPOINT实现密码的修改")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".编写Dockefile\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM malu-linux:v1.10\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给镜像打标签，用于替代MAINTAINER")]),s._v("\nLABEL "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("school")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mlau "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("class")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux94 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("hobby")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("k8s "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("email")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("111111")]),s._v("@qq.com\n\nRUN apk "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" openssh-server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    ssh-keygen "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s@#PermitRootLogin prohibit-password@PermitRootLogin yes@'")]),s._v(" /etc/ssh/sshd_config\n\n\nCOPY script/start.sh /\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#CMD ["/bin/sh","-x","/start.sh"]')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#ENTRYPOINT ["/bin/sh","-x","/start.sh"]')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#ENTRYPOINT ["tail","-f"]')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#CMD ["/etc/hosts"]')]),s._v("\n\nENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MALU_PWD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v("\n\nENTRYPOINT "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-x"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/start.sh"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n-----------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat script/start.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/sh")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" \n  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" root:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" chpasswd\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" \n  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" root:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${MALU_PWD}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" chpasswd \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# start sshd service")]),s._v("\n/usr/sbin/sshd\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# start nginx service")]),s._v("\nnginx "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'daemon off;'")]),s._v("\n\n-----------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh 14")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP -e MALU_PWD=321 malu-linux:v1.1")]),s._v("\nv1.10  v1.11  v1.12  v1.13  v1.14  \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP -e MALU_PWD=321 malu-linux:v1.14 linux")]),s._v("\ncce210bbf2b1eed2ad76a68d8215332d94055969da5d08586510e62f4b01ae05\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l --no-trunc")]),s._v("\nCONTAINER ID                                                       IMAGE              COMMAND                        CREATED         STATUS         PORTS                                                                              NAMES\ncce210bbf2b1eed2ad76a68d8215332d94055969da5d08586510e62f4b01ae05   malu-linux:v1.14   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh -x /start.sh linux"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" seconds   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32789-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32789-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32788-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32788-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   tender_gauss\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec tender_gauss env")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOSTNAME")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cce210bbf2b1\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MALU_PWD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("321")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ADDRESS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zz\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ClassRoom")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1520")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOME")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh 10.0.0.102 -p 32789")]),s._v("\nThe authenticity of "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[10.0.0.102]:32789 ([10.0.0.102]:32789)'")]),s._v(" can"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t be established.\nED25519 key fingerprint is SHA256:QNfUKxbhdNL3zTkuITS8R8HZiqupe2x7GQG98gn+aXQ.\nThis key is not known by any other names\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.102"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":32789"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("' (ED25519) to the list of known hosts.\nroot@10.0.0.102'")]),s._v("s password:  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 密码是linux")]),s._v("\nWelcome to Alpine"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("https://wiki.alpinelinux.org/"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\ncce210bbf2b1:~"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br")])]),n("h3",{attrs:{id:"_10-healthcheck实现容器内的服务检查"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-healthcheck实现容器内的服务检查"}},[s._v("#")]),s._v(" 10，HEALTHCHECK实现容器内的服务检查")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM malu-linux:v1.10\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给镜像打标签，用于替代MAINTAINER")]),s._v("\nLABEL "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("school")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mlau "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("class")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux94 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("hobby")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("k8s "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("email")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("111111")]),s._v("@qq.com\n\nRUN apk "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" openssh-server "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    ssh-keygen "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s@#PermitRootLogin prohibit-password@PermitRootLogin yes@'")]),s._v(" /etc/ssh/sshd_config "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/cache \n\n\nCOPY script/start.sh /\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#CMD ["/bin/sh","-x","/start.sh"]')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#ENTRYPOINT ["/bin/sh","-x","/start.sh"]')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#ENTRYPOINT ["tail","-f"]')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#CMD ["/etc/hosts"]')]),s._v("\n\nENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MALU_PWD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用HEALTHCHECK可以对容器内的服务进行健康检查。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 此状态最初为"starting". 每当健康检查通过时，它就会变成"healthy"（无论它以前处于什么状态）。')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 在连续失败一定次数后，就变成了"unhealthy"。')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 常见的可用参数:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\t--interval=DURATION (default: 30s)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#\t\t容器启动后，间隔多长时间进行健康检查，默认时30秒。也可以是分钟，比如"--interval=5m"。')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\t--timeout=DURATION (default: 30s)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\t\t如果单次运行检查花费的时间超过指定的秒数，则认为检查失败，默认超时时间时30秒。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\t--start-period=DURATION (default: 0s)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\t\t启动服务的延迟检查时间，即在这个时间段内检查失败将不记录最大的重试次数。默认为0，表示不延迟检查。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#\t\t\t(1)若在这个时间段内检查服务是健康的，则其状态会直接变更为"healthy"，')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\t\t\t(2)若在这个时间段内检查失败将不记录最大的重试次数。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\t--retries=N (default: 3)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\t\t重试检查失败的次数，默认值为3.")]),s._v("\nHEALTHCHECK "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--interval")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1s "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--timeout")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("3s --start-period"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("10s "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--retries")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  CMD "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" http://localhost/ "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nENTRYPOINT "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-x"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/start.sh"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh 15")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP  malu-linux:v1.15 ")]),s._v("\n1225bfe39d883f51c9e831bcd68cb7d8b71207af95bdac57558084158b068345\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE              COMMAND                  CREATED         STATUS                   PORTS                                                                              NAMES\n1225bfe39d88   malu-linux:v1.15   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh -x /start.sh"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("healthy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32791-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32791-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32790-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32790-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   elated_kilby\n\n-------------------------\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#ENTRYPOINT ["/bin/sh","-x","/start.sh"]')]),s._v("\nENTRYPOINT "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sleep"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3600"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh 16")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -dP  malu-linux:v1.16 ")]),s._v("\n5b60395a7549bcab25d2d012d0e09bf0f15e5306768ec78381ce0ae157236a7d\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE              COMMAND        CREATED         STATUS                            PORTS                                                                              NAMES\n5b60395a7549   malu-linux:v1.16   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sleep 3600"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" seconds "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("health: starting"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32793-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32793-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32792-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32792-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   intelligent_buck\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE              COMMAND        CREATED          STATUS                             PORTS                                                                              NAMES\n5b60395a7549   malu-linux:v1.16   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sleep 3600"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" seconds "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("health: starting"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32793-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32793-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32792-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32792-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   intelligent_buck\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case03-nginx-games-sshd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE              COMMAND        CREATED          STATUS                      PORTS                                                                              NAMES\n5b60395a7549   malu-linux:v1.16   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sleep 3600"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" seconds "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("unhealthy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32793-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, :::32793-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32792-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::32792-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   intelligent_buck\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br")])]),n("h3",{attrs:{id:"_11-onbuild基础镜像触发器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_11-onbuild基础镜像触发器"}},[s._v("#")]),s._v(" 11，ONBUILD基础镜像触发器")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("此指令时在运行FROM时，会被触发执行\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir case04-multiple")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd case04-multiple/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat xixi.dockerfile ")]),s._v("\nFROM alpine\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /xixi\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定基础镜像触发器，凡是调用本镜像都会被触发执行这些Dockerfile")]),s._v("\nONBUILD RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /malu/aaa "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /malu/bbb\n\nONBUILD EXPOSE "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n\n\nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-f"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/hosts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n-------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat haha.dockerfile ")]),s._v("\nFROM xixi:v1\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /haha\n\n-------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image build "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" xixi:v1 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" xixi.dockerfile "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image build "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" xixi:v2 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" haha.dockerfile "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n-------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod +x build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh ")]),s._v("\nSending build context to Docker daemon  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".096kB\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/5 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" FROM alpine\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 91ef0af61f39\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/5 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /xixi\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image ls")]),s._v("\nREPOSITORY                     TAG       IMAGE ID       CREATED          SIZE\nxixi                           v2        6ce0d17ca999   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" seconds ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8MB\nxixi                           v1        f9c20b0f178b   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" seconds ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8MB\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it xixi:v1 sh")]),s._v("\n/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -l /")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 bin\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("360")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:59 dev\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:59 etc\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 home\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 lib\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 media\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 mnt\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 opt\ndr-xr-xr-x  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("293")]),s._v(" root     root             "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:59 proc\ndrwx------    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:59 root\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 run\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 sbin\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 srv\ndr-xr-xr-x   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" root     root             "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:59 sys\ndrwxrwxrwt    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 tmp\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 usr\ndrwxr-xr-x   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 var\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:57 xixi\n/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it xixi:v2 sh")]),s._v("\n/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -l /")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("68")]),s._v("\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 bin\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("360")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:59 dev\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:59 etc\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:57 haha\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 home\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 lib\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:57 malu\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 media\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 mnt\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 opt\ndr-xr-xr-x  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("314")]),s._v(" root     root             "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:59 proc\ndrwx------    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:59 root\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 run\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 sbin\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 srv\ndr-xr-xr-x   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" root     root             "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:59 sys\ndrwxrwxrwt    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 tmp\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 usr\ndrwxr-xr-x   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 var\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:57 xixi\n/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd malu/")]),s._v("\n/malu "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -l")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:57 aaa\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 03:57 bbb\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br")])]),n("h3",{attrs:{id:"_12-user用于不允许root用户运行的服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_12-user用于不允许root用户运行的服务"}},[s._v("#")]),s._v(" 12，USER用于不允许root用户运行的服务")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("比如elasticsearch就不允许root用户运行\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":56 ./\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":53 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/\n-rwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("115")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":56 build.sh*\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":56 haha.dockerfile\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("230")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":54 xixi.dockerfile\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat xixi.dockerfile ")]),s._v("\nFROM alpine\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /xixi\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定基础镜像触发器，凡是调用本镜像都会被触发执行这些Dockerfile")]),s._v("\nONBUILD RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /malu/aaa "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /malu/bbb\n\nONBUILD EXPOSE "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n\n\nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-f"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/hosts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n---------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat haha.dockerfile ")]),s._v("\nFROM xixi:v1\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /haha "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" adduser linux94 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-D")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" linux94\n\n---------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image build "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" xixi:v1 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" xixi.dockerfile "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image build "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" xixi:v2 "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" haha.dockerfile "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n---------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it xixi:v2 sh")]),s._v("\ndocker: Error response from daemon: unable to "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" user linux94: no matching entries "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" file.\nERRO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("0000"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" error waiting "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" container: context canceled \n\n------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case04-multiple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it xixi:v2 sh")]),s._v("\n/ $ \n/ $ \n/ $ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("whoami")]),s._v("\nlinux94\n/ $ \n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br")])]),n("h3",{attrs:{id:"_13-shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_13-shell"}},[s._v("#")]),s._v(" 13，SHELL")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("推荐阅读: https://docs.docker.com/reference/dockerfile/\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_14-dockerfile的多阶段构建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_14-dockerfile的多阶段构建"}},[s._v("#")]),s._v(" 14，Dockerfile的多阶段构建")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case05-mutiple-build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM alpine AS xixi\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /malu/ "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dd")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/zero "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("of")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/malu/xixi.bigfile "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bs")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1M "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("count")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" www.xxx.com "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /malu/office.log\n\nFROM alpine AS haha\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /linux94 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dd")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/zero "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("of")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/linux94/xixi.bigfile "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bs")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1M "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("count")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" www.yyy.com "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /linux94/office2.log\n\nFROM alpine\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /maluedu\n\nCOPY "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--from")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xixi /malu/office.log /maluedu\nCOPY "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--from")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("haha /linux94/office2.log /maluedu\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case05-mutiple-build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" xixi:v3 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n-------------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case05-mutiple-build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod +x build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case05-mutiple-build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh ")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case05-mutiple-build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image ls")]),s._v("\nREPOSITORY                     TAG       IMAGE ID       CREATED             SIZE\nxixi                           v3        80b344e1bd13   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" seconds ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8MB\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("    9708a62d7d64   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" seconds ago      276MB\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("    4dfdbf4b402a   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" seconds ago      545MB\n\n-------------------------\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case05-mutiple-build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image ls -a")]),s._v("\nREPOSITORY                     TAG       IMAGE ID       CREATED              SIZE\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("    73d7fd379c1c   About a minute ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8MB\nxixi                           v3        80b344e1bd13   About a minute ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8MB\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("    50cee827c758   About a minute ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8MB\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("    9708a62d7d64   About a minute ago   276MB\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("    4dfdbf4b402a   About a minute ago   545MB\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("使用多阶段改写编译安装的nginx服务\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir case06-mutiple-build-nginx")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd case06-mutiple-build-nginx/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case06-mutiple-build-nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim Dockerfile")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case06-mutiple-build-nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM alpine AS mynginx\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s#dl-cdn.alpinelinux.org#mirrors.aliyun.com#'")]),s._v(" /etc/apk/repositories "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    apk update "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" apk  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" openssh-server "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" gcc g++ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://sourceforge.net/projects/pcre/files/pcre/8.44/pcre-8.44.tar.gz"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.org/download/nginx-1.20.1.tar.gz"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf pcre-8.44.tar.gz  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf nginx-1.20.1.tar.gz "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" nginx-1.20.1  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    ./configure "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/nginx --with-pcre"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/pcre-8.44 --without-http_gzip_module "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n\nFROM alpine\n\nMAINTAINER  oldboyedu-linux80\n\nLABEL "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("school")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("oldboyedu "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("class")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux80 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("auther")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("oldboyedu-linux80 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("address")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"老男孩it教育沙河镇"')]),s._v("\n\nCOPY "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--from")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mynginx /usr/local/nginx /usr/local/nginx\n\nRUN  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s#dl-cdn.alpinelinux.org#mirrors.aliyun.com#'")]),s._v(" /etc/apk/repositories "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n     apk update "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" apk  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" openssh-server "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n     "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s@#PermitRootLogin prohibit-password@PermitRootLogin yes@g'")]),s._v(" /etc/ssh/sshd_config "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n     "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sv")]),s._v(" /usr/local/nginx/sbin/nginx /usr/sbin "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n     "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/cache/ \n\nCOPY  config/nginx.conf /etc/nginx/nginx.conf\n\nADD code/oldboyedu-game-code.tar.gz /usr/local/nginx/html\n\nCOPY script/start-web.sh /\n\nEXPOSE "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n\nVOLUME /usr/local/nginx/html\n\nWORKDIR /usr/local/nginx/html\n\nENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("school")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("oldboyedu "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("class")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux80 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("OLDBOYEDU_ADMIN")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jiubugaosuni"')]),s._v("\n\nHEALTHCHECK  "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--interval")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("3s "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n             "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--timeout")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("3s "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n             --start-period"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("30s "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n             "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--retries")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n             CMD "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" http://localhost/ "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sh"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-x"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/start-web.sh"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br")])]),n("h3",{attrs:{id:"_15-使用-scratch-自定义linux镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_15-使用-scratch-自定义linux镜像"}},[s._v("#")]),s._v(" 15，使用'scratch'自定义Linux镜像")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("温馨提示:\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("镜像的根目录可以使用"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker container export"')]),s._v("导出我们心仪的根目录"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("当然，镜像目录也可以直接去第三方库下载哟:\nhttps://mirrors.tuna.tsinghua.edu.cn/lxc-images/images/alpine/3.20/amd64/default/20241105_13%3A27/rootfs.tar.xz\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir case07-scratch")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd case07-scratch/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":28 ./\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":28 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wget https://mirrors.tuna.tsinghua.edu.cn/lxc-images/images/alpine/3.20/amd64/default/20241105_13%3A27/rootfs.tar.xz")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3072")]),s._v("\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":29 ./\ndrwxr-xr-x "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" root root    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":28 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3134964")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":42 rootfs.tar.xz\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM scratch\n\nADD rootfs.tar.xz /\n\nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-f"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/hosts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" malu-linux:2.0 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod +x build.sh ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./build.sh ")]),s._v("\nSending build context to Docker daemon  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".139MB\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/3 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" FROM scratch\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" \nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/3 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ADD rootfs.tar.xz /\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" c8987fc14621\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/3 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" CMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-f"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/hosts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 3f3ae07a3bab\nRemoving intermediate container 3f3ae07a3bab\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" c0387a085e8c\nSuccessfully built c0387a085e8c\nSuccessfully tagged malu-linux:2.0\n\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image ls")]),s._v("\nREPOSITORY                     TAG       IMAGE ID       CREATED             SIZE\nmalu-linux                     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v("       c0387a085e8c   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" seconds ago      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".6MB\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d malu-linux:2.0 ")]),s._v("\n22e5a10449b580535f60ac6675b370bbdefbcfef506a90c40111c44666292f37\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -l")]),s._v("\nCONTAINER ID   IMAGE            COMMAND                CREATED         STATUS         PORTS     NAMES\n22e5a10449b5   malu-linux:2.0   "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail -f /etc/hosts"')]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" seconds ago   Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" seconds             vigilant_goldstine\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case07-scratch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it vigilant_goldstine sh")]),s._v("\n/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -l")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v("\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":28 bin\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("340")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 04:37 dev\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 04:37 etc\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 home\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":28 lib\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 media\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 mnt\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 opt\ndr-xr-xr-x  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("288")]),s._v(" root     root             "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 04:37 proc\ndrwx------    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 04:37 root\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 run\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":28 sbin\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 srv\ndr-xr-xr-x   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" root     root             "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" 04:37 sys\ndrwxrwxrwt    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 tmp\ndrwxr-xr-x    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Nov  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":28 usr\ndrwxr-xr-x   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" root     root          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":34 var\n/ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br")])]),n("h3",{attrs:{id:"_16-dockerfile的优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16-dockerfile的优化"}},[s._v("#")]),s._v(" 16，dockerfile的优化")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("dockerfile的优化原则简而言之为："),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"构建的镜像尽可能小，构建速度尽可能快"')]),s._v("。\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".编译速度快\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("将不经常变更的指令放在靠前位置，频繁修改的指令靠后写，从而达到可以充分利用缓存镜像的目的"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("在不影响功能的前提下，可以合并多条指令，减少镜像的层数，从而减少中间容器的启动"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 tmp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM alpine\n\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" /oldboyedu-linux94 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n \nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" /oldboyedu-haha "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\n \nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tail"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-f"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/hosts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 tmp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 tmp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("使用"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('".dockerignore"')]),s._v("来忽略不需要发送给docker daemon进程的文件"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 tmp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat .dockerignore ")]),s._v("\nbigfile\nsystemd*\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 tmp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("修改软件源地址，比如yum，apt，apk源建议使用国内的，可以明显看出来速度的提升"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n---------------------\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".镜像体积小\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("删除缓存文件，比如"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rm -rf /var/cache/{apt,yum}"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("卸载无用的软件包，比如编译安装后的编译器，下载的软件包等都可以被卸载哟，也可以采用多阶段构建"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("使用较小的基础镜像，比如alpine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n---------------------\n\n温馨提示:\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("大多数开源的Linux镜像默认都是用了标准C语言编译器glibC,这会占用很大一部分空间，而alpine使用musl libc和BusyBox构建的Linux发行版"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("alpine和其它linux发行版相比就是体积小，但也可能会存在部分软件不兼容的情况哟，如果alpine无法兼容一些软件时，可以考虑使用Ubuntu22.04镜像，因为其77+MB，最后再考虑使用centos镜像，因为其镜像大小超过240+MB。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br")])]),n("h3",{attrs:{id:"_17-docker-compose"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_17-docker-compose"}},[s._v("#")]),s._v(" 17，docker-compose")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".什么是docker-compose \n所谓的docker compose就是实现一组docker容器的管理工具。\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".使用docker-compose部署zabbix案例\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir docker-compose")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd docker-compose/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 docker-compose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir case01-zabbix")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 docker-compose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd case01-zabbix/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pwd")]),s._v("\n/root/docker-compose/case01-zabbix\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat docker-compose.yaml ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 声明docker-compose的版本，未来该参数会被移除!")]),s._v("\nversion: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.8'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义各个服务类型")]),s._v("\nservices:\n   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 我们可以自定义服务的名称，最好见名之意")]),s._v("\n   mysql-server:\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定镜像的地址")]),s._v("\n     image: mysql:8.0.36-oracle\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定容器的名称")]),s._v("\n     container_name: mysql-server\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定重启策略")]),s._v("\n     restart: unless-stopped\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定环境变量")]),s._v("\n     environment:\n       MYSQL_ROOT_PASSWORD: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v("\n       MYSQL_DATABASE: zabbix\n       MYSQL_USER: linux94\n       MYSQL_PASSWORD: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 加入自定义网络")]),s._v("\n     networks:\n       - zabbix-net\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动是传参")]),s._v("\n     command: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--character-set-server=utf8"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--collation-server=utf8_bin"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--default-authentication-plugin=mysql_native_password"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n     \n   zabbix-java-gateway:\n     container_name: zabbix-java-gateway\n     image: zabbix/zabbix-java-gateway:alpine-7.0-latest\n     restart: unless-stopped\n     networks:\n       - zabbix-net\n     \n   zabbix-server:\n     container_name: zabbix-server-mysql\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 依赖哪个服务")]),s._v("\n     depends_on:\n       - mysql-server\n     image: zabbix/zabbix-server-mysql:alpine-7.0-latest\n     restart: unless-stopped\n     environment:\n       DB_SERVER_HOST: mysql-server\n       MYSQL_DATABASE: zabbix\n       MYSQL_USER: linux94\n       MYSQL_PASSWORD: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n       MYSQL_ROOT_PASSWORD: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v("\n       ZBX_JAVAGATEWAY: zabbix-java-gateway\n     networks:\n       - zabbix-net\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定端口映射")]),s._v("\n     ports:\n       - "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10051:10051"')]),s._v("\n       \n   zabbix-web-nginx-mysql:\n     container_name: zabbix-web-nginx-mysql\n     depends_on:\n       - zabbix-server\n     image: zabbix/zabbix-web-nginx-mysql:alpine-7.0-latest\n     ports:\n       - "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"80:8080"')]),s._v("\n     restart: unless-stopped\n     environment:\n       DB_SERVER_HOST: mysql-server\n       MYSQL_DATABASE: zabbix\n       MYSQL_USER: linux94\n       MYSQL_PASSWORD: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n       MYSQL_ROOT_PASSWORD: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v("\n     networks:\n       - zabbix-net\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义网络深圳")]),s._v("\nnetworks:\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义网络的名称，可以自定义，此处定义上面的服务可以引用。")]),s._v("\n  zabbix-net:\n     name: maluedu-zabbix\n     ipam:\n       driver: default\n       config:\n         - subnet: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.20")]),s._v(".100.0/16\n           gateway: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.20")]),s._v(".100.254\n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给网络打标签")]),s._v("\n     labels:\n       school.edu.com: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xxxxx"')]),s._v("\n       class.edu.com: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Linux94"')]),s._v("\n       auther.edu.com: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wc"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".基本使用\t\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.1")]),s._v(" 创建容器并启动服务 \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose up -d")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.2")]),s._v(" 查看服务是否正在运行\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose ps -a")]),s._v("\n\n\t\t\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.3")]),s._v(" 停止服务并删除容器\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose down -t 0")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.4")]),s._v(" 停止服务并不删除容器\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose stop")]),s._v("\n\n\t\t\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.5")]),s._v(" 启动容器 \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose start")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.6")]),s._v(" 重启容器 \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose restart")]),s._v("\n\n\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.7")]),s._v(" 实时查看容器日志\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case01-zabbix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose logs -f mysql-server  # 前提是服务是正常运行的！")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br")])]),n("h3",{attrs:{id:"_18-docker-compose一键启动wp"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_18-docker-compose一键启动wp"}},[s._v("#")]),s._v(" 18，docker-compose一键启动wp")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".编写docker-compose配置文件\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-wordpress"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat docker-compose.yaml ")]),s._v("\nversion: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.8'")]),s._v("\n\nservices:\n  db:\n    image: mysql:8.0.36-oracle\n    container_name: db\n    restart: unless-stopped\n    environment:\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_DATABASE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wordpress\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ALLOW_EMPTY_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_USER")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义存储卷")]),s._v("\n    volumes:\n      - dbdata:/var/lib/mysql\n    networks:\n      - wordpress-network\n\n  wordpress:\n    depends_on:\n      - db\n    image: wordpress\n    container_name: wordpress\n    restart: unless-stopped\n    ports:\n      - "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"80:80"')]),s._v("\n    environment:\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WORDPRESS_DB_HOST")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("db:3306\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WORDPRESS_DB_USER")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WORDPRESS_DB_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WORDPRESS_DB_NAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wordpress\n    volumes:\n      - wordpress:/var/www/html\n    networks:\n      - wordpress-network\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义存储卷")]),s._v("\nvolumes:\n  wordpress:\n  dbdata:\n\nnetworks:\n  wordpress-network:\n    driver: bridge\n    ipam:\n      config:\n        - subnet: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.30")]),s._v(".100.0/24\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-wordpress"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".移除容器时可以使用"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-v"')]),s._v("移除存储卷\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker102 case02-wordpress"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose down -t 0 -v")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br")])])])}),[],!1,null,null,null);n.default=e.exports},7095:function(s,n,a){s.exports=a.p+"assets/img/1730991944504.0f3fe62d.png"},7096:function(s,n,a){s.exports=a.p+"assets/img/1730992098410.13b2b598.png"}}]);