(window.webpackJsonp=window.webpackJsonp||[]).push([[239],{14634:function(e,t,a){"use strict";a.r(t);var s=a(2),r=Object(s.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"原仓库地址-https-github-com-fishdrowned-ssl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#原仓库地址-https-github-com-fishdrowned-ssl"}},[e._v("#")]),e._v(" 原仓库地址："),t("a",{attrs:{href:"https://github.com/Fishdrowned/ssl",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/Fishdrowned/ssl"),t("OutboundLink")],1)]),e._v(" "),t("br"),e._v(" "),t("h1",{attrs:{id:"自签泛域名证书"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自签泛域名证书"}},[e._v("#")]),e._v(" 自签泛域名证书")]),e._v(" "),t("p",[e._v("此工具用于颁发泛域名证书，方便开发环境调试。")]),e._v(" "),t("p",[e._v("请勿用于生产环境，生产环境还是购买正式的证书。"),t("br"),e._v("\n或者到 "),t("a",{attrs:{href:"https://letsencrypt.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Let's Encrypt"),t("OutboundLink")],1),e._v(" 可以申请到免费证书"),t("br"),e._v("\n（支持多域名和泛域名）。")]),e._v(" "),t("h2",{attrs:{id:"优点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[e._v("#")]),e._v(" 优点")]),e._v(" "),t("ol",[t("li",[e._v("你可以创建任意网站证书，只需导入一次根证书，无需多次导入；")]),e._v(" "),t("li",[e._v("减少重复又无谓的组织信息输入，创建证书时只需要输入域名；")]),e._v(" "),t("li",[e._v("泛域名证书可以减少 "),t("code",[e._v("nginx")]),e._v(" 配置，例如你要模拟 CDN："),t("br"),e._v("\n假设你的项目网站是 "),t("code",[e._v("example.dev")]),e._v("，CDN 网站设置为 "),t("code",[e._v("cdn.example.dev")]),e._v("，"),t("br"),e._v("\n你只需在 "),t("code",[e._v("nginx")]),e._v(" 里面配置一个网站，"),t("code",[e._v("server_name")]),e._v(" 同时填写  "),t("code",[e._v("example.dev")]),t("br"),e._v("\n和 "),t("code",[e._v("cdn.example.dev")]),e._v("，它们可以使用同一个 "),t("code",[e._v("*.example.dev")]),e._v(" 的证书。")]),e._v(" "),t("li",[e._v("现在你只需要一个证书，就可以搞定所有项目网站！")])]),e._v(" "),t("p",[e._v("使用 "),t("code",[e._v("SAN")]),e._v(" 来支持多域名和泛域名：")]),e._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key attr-name"}},[e._v("subjectAltName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[e._v("DNS:*.one.dev,DNS:one.dev,DNS:*.two.dev,DNS:two.dev,DNS:*.three.dev,DNS:three.dev")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h2",{attrs:{id:"系统要求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统要求"}},[e._v("#")]),e._v(" 系统要求")]),e._v(" "),t("ol",[t("li",[e._v("Linux，openssl")]),e._v(" "),t("li",[e._v("事先用 "),t("code",[e._v("hosts")]),e._v(" 或者 "),t("code",[e._v("dnsmasq")]),e._v(" 解析你本地开发的域名，"),t("br"),e._v("\n例如把 "),t("code",[e._v("example.dev")]),e._v(" 指向 "),t("code",[e._v("127.0.0.1")])])]),e._v(" "),t("h2",{attrs:{id:"使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[e._v("#")]),e._v(" 使用")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("./gen.cert.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("domain"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("domain"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[e._v("2")]),e._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("domain"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[e._v("3")]),e._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("domain"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[e._v("4")]),e._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("把 "),t("code",[e._v("<domain>")]),e._v(" 替换成你的域名，例如 "),t("code",[e._v("example.dev")])]),e._v(" "),t("p",[e._v("运行的输出像这样：")]),e._v(" "),t("p",[t("img",{attrs:{src:"docs/output.png",alt:"Output Screen"}})]),e._v(" "),t("p",[e._v("如果有多个项目网站，可以把所有网站都加上去，用空格隔开。")]),e._v(" "),t("p",[e._v("生成的证书位于：")]),e._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("out/&lt;domain>/&lt;domain>.crt\nout/&lt;domain>/&lt;domain>.bundle.crt\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("证书有效期是 20 年，你可以修改 "),t("code",[e._v("ca.cnf")]),e._v(" 来修改这个年限。")]),e._v(" "),t("p",[e._v("根证书位于："),t("br"),e._v(" "),t("code",[e._v("out/root.crt")]),t("br"),e._v("\n成功之后，把根证书导入到操作系统里面，信任这个证书。")]),e._v(" "),t("p",[e._v("根证书的有效期是 20 年，你可以修改 "),t("code",[e._v("gen.root.sh")]),e._v(" 来修改这个年限。")]),e._v(" "),t("p",[e._v("证书私钥位于："),t("br"),e._v(" "),t("code",[e._v("out/cert.key.pem")])]),e._v(" "),t("p",[e._v("其中 "),t("code",[e._v("<domain>.bundle.crt")]),e._v(" 是已经拼接好 CA 的证书，可以添加到 "),t("code",[e._v("nginx")]),e._v(" 配置里面。"),t("br"),e._v("\n然后你就可以愉快地用 "),t("code",[e._v("https")]),e._v(" 来访问你本地的开发网站了。")]),e._v(" "),t("h2",{attrs:{id:"清空"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#清空"}},[e._v("#")]),e._v(" 清空")]),e._v(" "),t("p",[e._v("你可以运行 "),t("code",[e._v("flush.sh")]),e._v(" 来清空所有历史，包括根证书和网站证书。")]),e._v(" "),t("h2",{attrs:{id:"配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[e._v("#")]),e._v(" 配置")]),e._v(" "),t("p",[e._v("你可以修改 "),t("code",[e._v("ca.cnf")]),e._v(" 来修改你的证书年限。")]),e._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key attr-name"}},[e._v("default_days")]),e._v("    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[e._v("730")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("可以修改 "),t("code",[e._v("gen.root.sh")]),e._v(" 来自定义你的根证书名称和组织。")]),e._v(" "),t("p",[e._v("也可以修改 "),t("code",[e._v("gen.cert.sh")]),e._v(" 来自定义你的网站证书组织。")]),e._v(" "),t("h2",{attrs:{id:"参考-致谢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考-致谢"}},[e._v("#")]),e._v(" 参考 / 致谢")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://dunne.io/vault-and-self-signed-ssl-certificates",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vault and self signed SSL certificates"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"http://wangye.org/blog/archives/732/",target:"_blank",rel:"noopener noreferrer"}},[e._v("利用OpenSSL创建自签名的SSL证书备忘"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"http://security.stackexchange.com/questions/74345/provide-subjectaltname-to-openssl-directly-on-command-line",target:"_blank",rel:"noopener noreferrer"}},[e._v("Provide subjectAltName to openssl directly on command line"),t("OutboundLink")],1)]),e._v(" "),t("h2",{attrs:{id:"关于-let-s-encrypt-客户端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关于-let-s-encrypt-客户端"}},[e._v("#")]),e._v(" 关于 Let's Encrypt 客户端")]),e._v(" "),t("p",[e._v("官方客户端 "),t("code",[e._v("certbot")]),e._v(" "),t("a",{attrs:{href:"https://github.com/Neilpang/acme.sh/issues/386",target:"_blank",rel:"noopener noreferrer"}},[e._v("太复杂了"),t("OutboundLink")],1),e._v("，推荐使用 "),t("a",{attrs:{href:"https://github.com/Neilpang/acme.sh/wiki/%E8%AF%B4%E6%98%8E",target:"_blank",rel:"noopener noreferrer"}},[e._v("acme.sh"),t("OutboundLink")],1),e._v("。")]),e._v(" "),t("h2",{attrs:{id:"关于-dev-域名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关于-dev-域名"}},[e._v("#")]),e._v(" 关于 .dev 域名")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://ma.ttias.be/chrome-force-dev-domains-https-via-preloaded-hsts/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Chrome to force .dev domains to HTTPS via preloaded HSTS"),t("OutboundLink")],1),e._v(" ("),t("a",{attrs:{href:"https://chromium-review.googlesource.com/c/chromium/src/+/669923",target:"_blank",rel:"noopener noreferrer"}},[e._v("2017-9-16"),t("OutboundLink")],1),e._v(")")]),e._v(" "),t("h2",{attrs:{id:"关于-chrome-信任证书问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关于-chrome-信任证书问题"}},[e._v("#")]),e._v(" 关于 Chrome 信任证书问题")]),e._v(" "),t("p",[e._v("看到有人反映 Chrome 下无法信任证书，可参考 "),t("RouterLink",{attrs:{to:"/blogs/devops/39-shell 04/Dev-ops-sicpt(1)/Dev-ops-sicpt/08-ssl-tools/01-ssl-gen/docs/chrome-trust.html"}},[e._v("这个文档")])],1)])}),[],!1,null,null,null);t.default=r.exports}}]);